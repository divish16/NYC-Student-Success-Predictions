
CREATE TABLE "Demographics" (
    "DBN" varchar,
    "Name" varchar,
    "schoolyear" varchar,
    "total_enrollment" varchar,
    "grade9" varchar,
    "grade10" varchar,
    "grade11" varchar,
    "grade12" varchar,
    "ell_num" varchar,
    "ell_percent" varchar,
    "sped_num" varchar,
    "sped_percent" varchar,
    "ctt_num" varchar,
    "selfcontained_num" varchar,
    "asian_num" varchar,
    "asian_per" varchar,
    "black_num" varchar,
    "black_per" varchar,
    "hispanic_num" varchar,
    "hispanic_per" varchar,
    "white_num" varchar,
    "white_per" varchar,
    "male_num" varchar,
    "male_per" varchar,
    "female_num" varchar,
    "female_per" varchar,
    "frl_combined_percent" varchar
);

CREATE TABLE "Graduation" (
    "DBN" varchar,
    "School_Name" varchar,
    "Demographic_Category" varchar,
    "Demographic_Variable" varchar,
    "Cohort_Year" varchar,
    "Cohort" varchar,
    "Total_Cohort_Num" varchar,
    "Total_Grads_Num" varchar,
    "Total_Grads_Percent_of_Cohort" varchar,
    "Total_Regents_Num" varchar,
    "Total_Regents_Percent_of_Cohort" varchar,
    "Total_Regents_Percent_of_Grads" varchar,
    "Advanced_Regents_Num" varchar,
    "Advanced_Regents_Percent_of_Cohort" varchar,
    "Advanced_Regents_Percent_of_Grads" varchar,
    "Regents_Without_Advanced_Num" varchar,
    "Regents_Without_Advanced_Percent_of_Cohort" varchar,
    "Regents_Without_Advanced_Percent_of_Grads" varchar,
    "Local_Num" varchar,
    "Local_Percent_of_Cohort" varchar,
    "Local_Percent_of_Grads" varchar,
    "Still_Enrolled_Num" varchar,
    "Still_Enrolled_Percent_of_Cohort" varchar,
    "Dropped_Out_Num" varchar,
    "Dropped_Out_Percent_of_Cohort" varchar
);

CREATE TABLE "Poverty" (
    "DBN" varchar,
    "School_Name" varchar,
    "Year" varchar,
	"Total_Enrollment" varchar,
    "Grade9" varchar,
    "Grade10" varchar,
    "Grade11" varchar,
    "Grade12" varchar,
    "Num_Female" varchar,
    "Per_Female" varchar,
    "Num_Male" varchar,
    "Per_Male" varchar,
    "Num_Asian" varchar,
    "Per_Asian" varchar,
    "Num_Black" varchar,
    "Per_Black" varchar,
    "Num_Hispanic" varchar,
    "Per_Hispanic" varchar,
    "Num_Multi_Racial" varchar,
    "Per_Multi_Racial" varchar,
    "Num_Native_American" varchar,
    "Per_Native_American" varchar,
    "Num_White" varchar,
    "Per_White" varchar,
    "Num_Missing_Race_Data" varchar,
    "Per_Missing_Race_Data" varchar,
    "Num_Students_with_Disabilities" varchar,
    "Per_Students_with_Disabilities" varchar,
    "Num_English_Language_Learners" varchar,
    "Per_English_Language_Learners" varchar,
    "Num_Poverty" varchar,
    "Per_Poverty" varchar,
    "Economic_Need_Index" varchar
);

CREATE TABLE "Demo_Summary" (
    "Total_Enrollment" varchar,
    "Number_of_English_Language_Learners" varchar,
    "ELL_as_Percent_of_Total" varchar,
    "Sped" varchar,
    "Sped_as_Percent_of_Total" varchar,
    "Number_of_Male_Students" varchar,
    "Male_Students_as_Percent_of_Total" varchar,
    "Number_of_Female_Students" varchar,
    "Female_Students_as_Percent_of_Total" varchar,
    "Percent_of_Students_Receiving_Free_or_Reduced_Lunch" varchar,
    "DBN" varchar,
	PRIMARY KEY ("DBN")
);

CREATE TABLE "Grad_Summary" (
    "Total_Number_in_Cohort" varchar,
    "Total_Number_of_Grads" varchar,
    "Percentage_of_Grads_per_Cohort" varchar,
    "Total_Number_of_Regents" varchar,
    "All_Regents_as_Percentage_of_Cohort" varchar,
    "All_Regents_as_Percentage_of_Grads" varchar,
    "Number_of_Advanced_Regents" varchar,
    "Percentage_of_Advanced_Regents_per_Cohort" varchar,
    "Advanced_Regents_Percentage_of_Grads" varchar,
    "Nummber_of_Non_Advanced_Regents" varchar,
    "Percentage_of_Non_Advanced_Regents_per_Cohort" varchar,
    "Non_Advanced_Regents_Percentage_of_Grads" varchar,
    "Number_of_Local_Diplomas" varchar,
    "Percentage_of_Local_per_Cohort" varchar,
    "Local_as_Percentage_of_Grads" varchar,
    "Number_Still_Enrolled" varchar,
    "Percentage_of_Cohort_Still_Enrolled" varchar,
    "Number_Dropped_Out" varchar,
    "Dropped_Out_Percentage_of_Cohort" varchar,
	"DBN" varchar,
    PRIMARY KEY ("DBN")
);

CREATE TABLE "Poverty_Summary" (
    "Total_Enrollment" varchar,
    "Number_of_Students_with_Disabilities" varchar,
    "Percentage_of_Students_with_Disabilities" varchar,
    "Number_of_Students_in_Poverty" varchar,
    "Percentage_of_Students_in_Poverty" varchar,
    "Economic_Need_Index" varchar,
	"DBN" varchar,
	PRIMARY KEY ("DBN")
);

SELECT DISTINCT ON(d."DBN")d."DBN",
 d."ell_num",
 d."sped_num",
 d."asian_num",
 d."black_num",
 d."hispanic_num",
 d.white_num,
 d.male_num,
 d.female_num,
 gd."Total_Cohort_Num" ,
 gd."Total_Grads_Num",
 gd."Total_Regents_Num" ,
 gd."Advanced_Regents_Num" ,
 gd."Regents_Without_Advanced_Num",
 gd."Local_Num",
 gd."Still_Enrolled_Num" ,
 gd."Dropped_Out_Num",
 pt."School_Name",
 pt."Year",
 d."total_enrollment",
 pt."Num_Female",
 pt."Num_Male",
 pt."Num_Asian",
 pt."Num_Black",
 pt."Num_Hispanic",
 pt."Num_Multi_Racial",
 pt."Num_Native_American",
 pt."Num_White",
 pt."Num_English_Language_Learners",
 pt."Num_Poverty",
 pt."Economic_Need_Index"
INTO merged_data
FROM "Demographics" as d
	INNER JOIN "Graduation" as gd
	ON d."DBN"= gd."DBN"
	INNER JOIN "Poverty" as pt
	ON d."DBN" = pt."DBN"
ORDER BY "DBN";

SELECT * FROM "merged_data";
